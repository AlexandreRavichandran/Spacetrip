{% extends 'base.html.twig' %}

{% block title %}Ajouter un commentaire{% endblock %}

{% block body %}
<div class="container mt-2">
    <div class="row">
        <h1 class="ml-auto mr-auto"> Vaisseau {{spacecraft.name}}</h1>
    </div>
    <div class="row">
        <div class="col-4">
            <img src="https://placehold.it/300x300" alt="">
        </div>
        <div class="col-8">
            <p> {{spacecraft.description}} Lorem ipsum dolor sit amet consectetur adipisicing elit. Necessitatibus quam incidunt esse et quod nihil quisquam, eum labore praesentium odit ullam distinctio reiciendis at alias, consequuntur voluptatem minus hic sapiente. Tempore aut voluptate cupiditate. Quam, fugit? Unde eveniet, quos perferendis nesciunt explicabo debitis temporibus sapiente illum incidunt molestias possimus iste!</p>
            <div class="row">
                <table class="table table-hover">
                    <tbody>
                        <tr class="text-center">
                            <td> Nombre de sièges </td>
                            <td>{{spacecraft.numberOfSeat}}</td>
                        </tr>
                        <tr class="text-center">
                            <td> Vitesse</td>
                            <td>{{spacecraft.speed}} km/h</td>
                        </tr>
                        <tr class="text-center">
                            <td> Destinations possibles</td>
                            <td> <ul>{% for possibleDestination in spacecraft.possibleDestination %}<li>{{possibleDestination.name}}</li>{% endfor %}</ul></td>
                        </tr>
                        <tr class="text-center">
                            <td> Prix </td>
                            <td>{{formatPrice(spacecraft.reservationPrice,2)}} € + {{formatPrice(spacecraft.pricePerDistance,5)}} €/km</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="row mt-2">
        <p class="ml-auto mr-auto"> Note actuelle :</p>
    </div>
    <div class="row">
        <h1 class="ml-auto mr-auto">{{displayStarRating(spacecraft.rating)}}</h1>
    </div>
</div>

<div class="container mt-4">
    <div class="row">
        <h4 class="ml-auto mr-auto"> Donnez votre note pour ce vaisseau : </h4>
    </div>
    <div class="row">
        <p class="ml-auto mr-auto" style="font-size:30px"> <span><i id="ratingMinus" class="bi bi-dash"></i></span> <span id="userRating">{% for i in 0..4 %}<i class="bi bi-star"></i>{% endfor %}</span> <span><i id="ratingPlus" class="bi bi-plus"></i></span></p> 
    </div>
    {{form_start(form)}}
    <div class="row">
        <div class="col-4">
        {{form_widget(form.rating, {'id':'rating', 'attr':{'class':'invisible'}})}}
        </div>
    </div>  
    <div class="row">
        <div class="col">
        {{form_row(form.content,{id:"content"})}}
            <div class="d-flex justify-content-between">
            <p id="alert"></p>
            <p class="text-muted"><span id="character_count"> </span> /510 </p>
            </div>
        </div>
    </div>
    <div class="row d-flex justify-content-center">
      <button class="btn btn-primary"> Poster mon commentaire</button> 
    </div>
   
    {{form_end(form)}}


    
</div>
{% endblock %}

{% block javascripts %}
<script>
    $(document).ready(function(){
        $("#content").keyup(function(){
            let count = $('#content').val().length;
            console.log($("#content").val().length);
            $('#character_count').html(count);
        if(count > 510){
            $("#content").css("background-color","orange");
            $("#alert").html("Le commentaire est trop long.").css("color","red");
            $('button').attr('disabled','');
        }
        else{
            $("#content").css("background-color","");
            $("#alert").html("");
            $('button').removeAttr('disabled');
        }
        })

        $("#ratingPlus").click(function(){
            $("#userRating").prepend('<i class="bi bi-star-fill"></i>');
            $("#userRating i:last-child").remove();
            $("#rating").val($('#userRating .bi-star-fill').length)
        })
        $("#ratingMinus").click(function(){
            $("#userRating").append('<i class="bi bi-star"></i>');
            $("#userRating i:first-child").remove();
            $("#rating").val($('#userRating .bi-star-fill').length)
        })


    })

</script>
{% endblock %}