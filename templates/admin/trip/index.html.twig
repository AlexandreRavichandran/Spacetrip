{% extends 'base.html.twig' %}

{% block title %}[ADMIN] Liste des voyages {% endblock %}

{% block body %}
<div class="container-fluid ml-auto mr-auto mt-5">
    <h1 class="text-center"> Liste des voyages </h1>
    <div class="row">
        <div class="col-2">
            <a href="{{path('app_admin_trip_show_latest')}}" class="btn btn-primary btn-md rounded"><i class="bi bi-arrow-left"></i> Retour </a>
        </div>
        <div class="col-8 d-flex justify-content-center">
            <a href="{{path('app_admin_trip_index')}}" class="btn btn-primary btn-md rounded mr-5">Voir les voyages non reservés </a>
            <a href="{{path('app_admin_reserved_trips_index')}}" class="btn btn-primary btn-md rounded">Voir les voyages réservés </a>
        </div>
        <div class="col-2 align-self-end">
            <p><a href="{{path('app_admin_trip_create')}}">Créer un nouveau voyage</a></p>
        </div>
    </div>
    <div class="row mt-2">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col" class="text-center">Date de creation</th>
                    <th scope="col" class="text-center">Nom (Destination) <a href="{% if orderBy is same as 't.name' and order is same as 'DESC' %}{{path('app_admin_trip_sort',{'orderBy':'t.name','order':'ASC'})}}{% else %}{{path('app_admin_trip_sort',{'orderBy':'t.name','order':'DESC'})}}{% endif %}" class="{{setSortingIcon(orderBy,'t.name', order)}}"></a></th>
                    <th scope="col" class="text-center">Date de départ</th>
                    <th scope="col" class="text-center">Date d'arrivée</th>
                    <th scope="col" class="text-center">Vaisseau <a href="{% if orderBy is same as 's.name' and order is same as 'DESC' %}{{path('app_admin_trip_sort',{'orderBy':'s.name','order':'ASC'})}}{% else %}{{path('app_admin_trip_sort',{'orderBy':'s.name','order':'DESC'})}}{% endif %}" class="{{setSortingIcon(orderBy,'s.name', order)}}"></a></th>
                    <th scope="col" class="text-center">Nombre de sièges restants <a href="{% if orderBy is same as 't.availableSeatNumber' and order is same as 'DESC' %}{{path('app_admin_trip_sort',{'orderBy':'t.availableSeatNumber','order':'ASC'})}}{% else %}{{path('app_admin_trip_sort',{'orderBy':'t.availableSeatNumber','order':'DESC'})}}{% endif %}" class="{{setSortingIcon(orderBy,'t.availableSeatNumber', order)}}"></a></th>
                    <th scope="col" class="text-center">Statut <a href="{% if orderBy is same as 't.status' and order is same as 'DESC' %}{{path('app_admin_trip_sort',{'orderBy':'t.status','order':'ASC'})}}{% else %}{{path('app_admin_trip_sort',{'orderBy':'t.status','order':'DESC'})}}{% endif %}" class="{{setSortingIcon(orderBy,'t.status', order)}}"></a></th>
                    <th scope="col" class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
            {% for trip in trips %}
                <tr>
                    <td scope="col" class="text-center">{{trip.createdAt|date('d/m/Y H:i:s')}}</td>
                    <td scope="col" class="text-center">{{trip.name}} ({{trip.destination.name|upper}})</td>
                    <td scope="col" class="text-center">{{trip.departureAt|date('d/m/Y H:i:s')}}</td>
                    <td scope="col" class="text-center">{{trip.arrivalAt|date('d/m/Y H:i:s')}}</td>
                    <td scope="col" class="text-center">{{trip.spacecraft.name|upper}}</td>
                    <td scope="col" class="text-center">{{trip.availableSeatNumber}}</td>
                    <td scope="col" class="text-center">{{trip.status}}</td>
                    <td scope="col">
                        <a href="{{path('app_admin_trip_edit',{'id':trip.id})}}" class="btn btn-warning btn-sm">Editer</a>
                        <a onclick="event.preventDefault(); confirm('Etes vous sur de supprimer ce voyage de la base de données ? Cette action est irréversible.') && document.querySelector('#trip_delete_link_{{trip.id}}').click()"  class="btn btn-sm btn-danger ml-1"> Supprimer </a>
                        <a id="trip_delete_link_{{trip.id}}" style="display:none;" href="{{path('app_admin_trip_delete',{'id':trip.id})}}"></a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="navigation d-flex justify-content-center">
        {{knp_pagination_render(trips)}}
    </div>
</div>
{% endblock %}